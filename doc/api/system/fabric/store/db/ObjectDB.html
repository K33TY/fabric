<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_05) on Tue Jul 08 22:48:36 EDT 2014 -->
<title>ObjectDB</title>
<meta name="date" content="2014-07-08">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ObjectDB";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":6,"i3":6,"i4":10,"i5":6,"i6":6,"i7":10,"i8":10,"i9":6,"i10":10,"i11":10,"i12":6,"i13":10,"i14":10,"i15":10,"i16":6,"i17":10,"i18":6,"i19":6,"i20":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../fabric/store/db/MemoryDB.html" title="class in fabric.store.db"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../fabric/store/db/ObjectDB.PendingTransaction.html" title="class in fabric.store.db"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?fabric/store/db/ObjectDB.html" target="_top">Frames</a></li>
<li><a href="ObjectDB.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">fabric.store.db</div>
<h2 title="Class ObjectDB" class="title">Class ObjectDB</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>fabric.store.db.ObjectDB</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../fabric/store/db/BdbDB.html" title="class in fabric.store.db">BdbDB</a>, <a href="../../../fabric/store/db/MemoryDB.html" title="class in fabric.store.db">MemoryDB</a></dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="typeNameLabel">ObjectDB</span>
extends java.lang.Object</pre>
<div class="block"><p>
 An ObjectDB encapsulates the persistent state of the Store. It is responsible
 for storing and retrieving objects, and also for checking permissions.
 </p>
 <p>
 The ObjectDB interface is designed to support a two-phase commit protocol.
 Consequently to insert or modify an object, users must first call the
 prepare() method, passing in the set of objects to update. These objects will
 be stored, but will remain unavailable until the commit() method is called
 with the returned transaction identifier.
 </p>
 <p>
 In general, implementations of ObjectDB are not thread-safe. Only
 TransactionManager should be interacting directly with ObjectDB
 implementations; it is responsible for ensuring safe use of ObjectDB.
 </p>
 <p>
 All ObjectDB implementations should provide a constructor which takes the
 name of the store and its private key, and opens the appropriate back-end
 database if it exists, or creates it if it doesn't exist.
 </p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.PendingTransaction.html" title="class in fabric.store.db">ObjectDB.PendingTransaction</a></span></code>
<div class="block">The data stored for a partially prepared transaction.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.UpdateMode.html" title="enum in fabric.store.db">ObjectDB.UpdateMode</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#name">name</a></span></code>
<div class="block">The store's name.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../../../fabric/common/util/ConcurrentLongKeyMap.html" title="interface in fabric.common.util">ConcurrentLongKeyMap</a>&lt;<a href="../../../fabric/common/util/OidKeyHashMap.html" title="class in fabric.common.util">OidKeyHashMap</a>&lt;<a href="../../../fabric/store/db/ObjectDB.PendingTransaction.html" title="class in fabric.store.db">ObjectDB.PendingTransaction</a>&gt;&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#pendingByTid">pendingByTid</a></span></code>
<div class="block">
 The table of partially prepared transactions.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../fabric/common/util/ConcurrentLongKeyMap.html" title="interface in fabric.common.util">ConcurrentLongKeyMap</a>&lt;fabric.store.db.ObjectLocks&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#rwLocks">rwLocks</a></span></code>
<div class="block">Maps onums to ObjectLocks.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected </code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#ObjectDB-java.lang.String-java.security.PrivateKey-">ObjectDB</a></span>(java.lang.String&nbsp;name,
        java.security.PrivateKey&nbsp;privateKey)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#abortPrepare-long-fabric.lang.security.Principal-">abortPrepare</a></span>(long&nbsp;tid,
            <a href="../../../fabric/lang/security/Principal.html" title="interface in fabric.lang.security">Principal</a>&nbsp;worker)</code>
<div class="block">Rolls back a partially prepared transaction.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#beginTransaction-long-fabric.lang.security.Principal-">beginTransaction</a></span>(long&nbsp;tid,
                <a href="../../../fabric/lang/security/Principal.html" title="interface in fabric.lang.security">Principal</a>&nbsp;worker)</code>
<div class="block">Opens a new transaction.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>abstract void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#close--">close</a></span>()</code>
<div class="block">Gracefully shuts down the object database.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>abstract void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#commit-long-fabric.common.net.RemoteIdentity-fabric.store.SubscriptionManager-">commit</a></span>(long&nbsp;tid,
      <a href="../../../fabric/common/net/RemoteIdentity.html" title="class in fabric.common.net">RemoteIdentity</a>&lt;<a href="../../../fabric/worker/remote/RemoteWorker.html" title="class in fabric.worker.remote">RemoteWorker</a>&gt;&nbsp;workerIdentity,
      <a href="../../../fabric/store/SubscriptionManager.html" title="class in fabric.store">SubscriptionManager</a>&nbsp;sm)</code>
<div class="block">Causes the objects prepared in transaction [tid] to be committed.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#ensureInit--">ensureInit</a></span>()</code>
<div class="block">Ensures that the object database has been properly initialized.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>abstract boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#exists-long-">exists</a></span>(long&nbsp;onum)</code>
<div class="block">Checks whether an object with the corresponding onum exists, in either
 prepared or committed form.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>abstract void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#finishPrepare-long-fabric.lang.security.Principal-">finishPrepare</a></span>(long&nbsp;tid,
             <a href="../../../fabric/lang/security/Principal.html" title="interface in fabric.lang.security">Principal</a>&nbsp;worker)</code>
<div class="block">
 Notifies the database that the given transaction is finished preparing.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#getName--">getName</a></span>()</code>
<div class="block">Returns the name of this store.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#getVersion-long-">getVersion</a></span>(long&nbsp;onum)</code>
<div class="block">Returns the version number on the object stored at a particular onum.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>protected abstract boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#isInitialized--">isInitialized</a></span>()</code>
<div class="block">Determines whether the object database has been initialized.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#isPrepared-long-long-">isPrepared</a></span>(long&nbsp;onum,
          long&nbsp;tid)</code>
<div class="block">Determines whether an onum has an outstanding uncommitted conflicting
 change or read.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#isWritten-long-">isWritten</a></span>(long&nbsp;onum)</code>
<div class="block">Determines whether an onum has outstanding uncommitted changes.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>abstract long[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#newOnums-int-">newOnums</a></span>(int&nbsp;num)</code>
<div class="block">
 Returns a set of onums that aren't currently occupied.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#notifyCommittedUpdate-fabric.store.SubscriptionManager-long-fabric.worker.remote.RemoteWorker-">notifyCommittedUpdate</a></span>(<a href="../../../fabric/store/SubscriptionManager.html" title="class in fabric.store">SubscriptionManager</a>&nbsp;sm,
                     long&nbsp;onum,
                     <a href="../../../fabric/worker/remote/RemoteWorker.html" title="class in fabric.worker.remote">RemoteWorker</a>&nbsp;worker)</code>
<div class="block">Performs operations in response to a committed object update.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#prepareRead-long-fabric.lang.security.Principal-long-int-fabric.common.util.LongKeyMap-">prepareRead</a></span>(long&nbsp;tid,
           <a href="../../../fabric/lang/security/Principal.html" title="interface in fabric.lang.security">Principal</a>&nbsp;worker,
           long&nbsp;onum,
           int&nbsp;version,
           <a href="../../../fabric/common/util/LongKeyMap.html" title="interface in fabric.common.util">LongKeyMap</a>&lt;<a href="../../../fabric/common/SerializedObject.html" title="class in fabric.common">SerializedObject</a>&gt;&nbsp;versionConflicts)</code>
<div class="block">Prepares a read against the database.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#prepareUpdate-long-fabric.lang.security.Principal-fabric.common.SerializedObject-fabric.common.util.LongKeyMap-fabric.store.db.ObjectDB.UpdateMode-">prepareUpdate</a></span>(long&nbsp;tid,
             <a href="../../../fabric/lang/security/Principal.html" title="interface in fabric.lang.security">Principal</a>&nbsp;worker,
             <a href="../../../fabric/common/SerializedObject.html" title="class in fabric.common">SerializedObject</a>&nbsp;obj,
             <a href="../../../fabric/common/util/LongKeyMap.html" title="interface in fabric.common.util">LongKeyMap</a>&lt;<a href="../../../fabric/common/SerializedObject.html" title="class in fabric.common">SerializedObject</a>&gt;&nbsp;versionConflicts,
             <a href="../../../fabric/store/db/ObjectDB.UpdateMode.html" title="enum in fabric.store.db">ObjectDB.UpdateMode</a>&nbsp;mode)</code>
<div class="block">Prepares a create/write against the database.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>abstract <a href="../../../fabric/common/SerializedObject.html" title="class in fabric.common">SerializedObject</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#read-long-">read</a></span>(long&nbsp;onum)</code>
<div class="block">Returns the object stored at a particular onum.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code><a href="../../../fabric/store/db/GroupContainer.html" title="class in fabric.store.db">GroupContainer</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#readGroup-long-">readGroup</a></span>(long&nbsp;onum)</code>
<div class="block">Returns a GroupContainer for the object stored at a particular onum.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>abstract void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#rollback-long-fabric.lang.security.Principal-">rollback</a></span>(long&nbsp;tid,
        <a href="../../../fabric/lang/security/Principal.html" title="interface in fabric.lang.security">Principal</a>&nbsp;worker)</code>
<div class="block">Causes the objects prepared in transaction [tid] to be discarded.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>protected abstract void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#setInitialized--">setInitialized</a></span>()</code>
<div class="block">Sets a flag to indicate that the object database has been initialized.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../fabric/store/db/ObjectDB.html#unpin-fabric.store.db.ObjectDB.PendingTransaction-">unpin</a></span>(<a href="../../../fabric/store/db/ObjectDB.PendingTransaction.html" title="class in fabric.store.db">ObjectDB.PendingTransaction</a>&nbsp;tx)</code>
<div class="block">Adjusts rwLocks to account for the fact that the given transaction is about
 to be committed or aborted.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="name">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>name</h4>
<pre>protected final&nbsp;java.lang.String name</pre>
<div class="block">The store's name.</div>
</li>
</ul>
<a name="pendingByTid">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pendingByTid</h4>
<pre>protected final&nbsp;<a href="../../../fabric/common/util/ConcurrentLongKeyMap.html" title="interface in fabric.common.util">ConcurrentLongKeyMap</a>&lt;<a href="../../../fabric/common/util/OidKeyHashMap.html" title="class in fabric.common.util">OidKeyHashMap</a>&lt;<a href="../../../fabric/store/db/ObjectDB.PendingTransaction.html" title="class in fabric.store.db">ObjectDB.PendingTransaction</a>&gt;&gt; pendingByTid</pre>
<div class="block"><p>
 The table of partially prepared transactions. Note that this does not need
 to be saved to stable storage, since we only need to persist transactions
 that are fully prepared.
 </p>
 <p>
 Maps tids to principal oids to PendingTransactions.
 </p></div>
</li>
</ul>
<a name="rwLocks">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>rwLocks</h4>
<pre>protected final&nbsp;<a href="../../../fabric/common/util/ConcurrentLongKeyMap.html" title="interface in fabric.common.util">ConcurrentLongKeyMap</a>&lt;fabric.store.db.ObjectLocks&gt; rwLocks</pre>
<div class="block">Maps onums to ObjectLocks. This should be recomputed from the set of
 prepared transactions when restoring from stable storage.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ObjectDB-java.lang.String-java.security.PrivateKey-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ObjectDB</h4>
<pre>protected&nbsp;ObjectDB(java.lang.String&nbsp;name,
                   java.security.PrivateKey&nbsp;privateKey)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="beginTransaction-long-fabric.lang.security.Principal-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>beginTransaction</h4>
<pre>public final&nbsp;void&nbsp;beginTransaction(long&nbsp;tid,
                                   <a href="../../../fabric/lang/security/Principal.html" title="interface in fabric.lang.security">Principal</a>&nbsp;worker)
                            throws <a href="../../../fabric/common/exceptions/AccessException.html" title="class in fabric.common.exceptions">AccessException</a></pre>
<div class="block">Opens a new transaction.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>worker</code> - the worker under whose authority the transaction is running.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../fabric/common/exceptions/AccessException.html" title="class in fabric.common.exceptions">AccessException</a></code> - if the worker has insufficient privileges.</dd>
</dl>
</li>
</ul>
<a name="prepareRead-long-fabric.lang.security.Principal-long-int-fabric.common.util.LongKeyMap-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareRead</h4>
<pre>public final&nbsp;void&nbsp;prepareRead(long&nbsp;tid,
                              <a href="../../../fabric/lang/security/Principal.html" title="interface in fabric.lang.security">Principal</a>&nbsp;worker,
                              long&nbsp;onum,
                              int&nbsp;version,
                              <a href="../../../fabric/common/util/LongKeyMap.html" title="interface in fabric.common.util">LongKeyMap</a>&lt;<a href="../../../fabric/common/SerializedObject.html" title="class in fabric.common">SerializedObject</a>&gt;&nbsp;versionConflicts)
                       throws <a href="../../../fabric/worker/TransactionPrepareFailedException.html" title="class in fabric.worker">TransactionPrepareFailedException</a></pre>
<div class="block">Prepares a read against the database.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tid</code> - the identifier for the transaction preparing the read.</dd>
<dd><code>worker</code> - the worker preparing the read.</dd>
<dd><code>onum</code> - the object number that was read.</dd>
<dd><code>version</code> - the version that was read.</dd>
<dd><code>versionConflicts</code> - a map containing the transaction's version-conflict information.
          If the object read was out of date, then a new entry will be added
          to this map, binding the object's onum to its current version.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../fabric/worker/TransactionPrepareFailedException.html" title="class in fabric.worker">TransactionPrepareFailedException</a></code></dd>
</dl>
</li>
</ul>
<a name="prepareUpdate-long-fabric.lang.security.Principal-fabric.common.SerializedObject-fabric.common.util.LongKeyMap-fabric.store.db.ObjectDB.UpdateMode-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareUpdate</h4>
<pre>public final&nbsp;void&nbsp;prepareUpdate(long&nbsp;tid,
                                <a href="../../../fabric/lang/security/Principal.html" title="interface in fabric.lang.security">Principal</a>&nbsp;worker,
                                <a href="../../../fabric/common/SerializedObject.html" title="class in fabric.common">SerializedObject</a>&nbsp;obj,
                                <a href="../../../fabric/common/util/LongKeyMap.html" title="interface in fabric.common.util">LongKeyMap</a>&lt;<a href="../../../fabric/common/SerializedObject.html" title="class in fabric.common">SerializedObject</a>&gt;&nbsp;versionConflicts,
                                <a href="../../../fabric/store/db/ObjectDB.UpdateMode.html" title="enum in fabric.store.db">ObjectDB.UpdateMode</a>&nbsp;mode)
                         throws <a href="../../../fabric/worker/TransactionPrepareFailedException.html" title="class in fabric.worker">TransactionPrepareFailedException</a></pre>
<div class="block">Prepares a create/write against the database.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tid</code> - the identifier for the transaction preparing the create/write.</dd>
<dd><code>worker</code> - the worker preparing the create/write.</dd>
<dd><code>obj</code> - the modified object.</dd>
<dd><code>versionConflicts</code> - a map containing the transaction's version-conflict information.
          If the object modified was out of date, then a new entry will be
          added to this map, binding the object's onum to its current
          version.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../fabric/worker/TransactionPrepareFailedException.html" title="class in fabric.worker">TransactionPrepareFailedException</a></code></dd>
</dl>
</li>
</ul>
<a name="abortPrepare-long-fabric.lang.security.Principal-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>abortPrepare</h4>
<pre>public final&nbsp;void&nbsp;abortPrepare(long&nbsp;tid,
                               <a href="../../../fabric/lang/security/Principal.html" title="interface in fabric.lang.security">Principal</a>&nbsp;worker)</pre>
<div class="block">Rolls back a partially prepared transaction. (i.e., one for which
 finishPrepare() has yet to be called.)</div>
</li>
</ul>
<a name="finishPrepare-long-fabric.lang.security.Principal-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>finishPrepare</h4>
<pre>public abstract&nbsp;void&nbsp;finishPrepare(long&nbsp;tid,
                                   <a href="../../../fabric/lang/security/Principal.html" title="interface in fabric.lang.security">Principal</a>&nbsp;worker)</pre>
<div class="block"><p>
 Notifies the database that the given transaction is finished preparing. The
 transaction is not considered to be prepared until this is called. After
 calling this method, there should not be any further calls to
 registerRead() or registerUpdate() for the given transaction. This method
 MUST be called before calling commit().
 </p>
 <p>
 Upon receiving this call, the object database should save the prepared
 transaction to stable storage so that it can be recovered in case of
 failure.
 </p></div>
</li>
</ul>
<a name="commit-long-fabric.common.net.RemoteIdentity-fabric.store.SubscriptionManager-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commit</h4>
<pre>public abstract&nbsp;void&nbsp;commit(long&nbsp;tid,
                            <a href="../../../fabric/common/net/RemoteIdentity.html" title="class in fabric.common.net">RemoteIdentity</a>&lt;<a href="../../../fabric/worker/remote/RemoteWorker.html" title="class in fabric.worker.remote">RemoteWorker</a>&gt;&nbsp;workerIdentity,
                            <a href="../../../fabric/store/SubscriptionManager.html" title="class in fabric.store">SubscriptionManager</a>&nbsp;sm)
                     throws <a href="../../../fabric/common/exceptions/AccessException.html" title="class in fabric.common.exceptions">AccessException</a></pre>
<div class="block">Causes the objects prepared in transaction [tid] to be committed. The
 changes will hereafter be visible to read.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tid</code> - the transaction id</dd>
<dd><code>workerIdentity</code> - the remote worker that is performing the commit</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../fabric/common/exceptions/AccessException.html" title="class in fabric.common.exceptions">AccessException</a></code> - if the principal differs from the caller of prepare()</dd>
</dl>
</li>
</ul>
<a name="rollback-long-fabric.lang.security.Principal-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>rollback</h4>
<pre>public abstract&nbsp;void&nbsp;rollback(long&nbsp;tid,
                              <a href="../../../fabric/lang/security/Principal.html" title="interface in fabric.lang.security">Principal</a>&nbsp;worker)
                       throws <a href="../../../fabric/common/exceptions/AccessException.html" title="class in fabric.common.exceptions">AccessException</a></pre>
<div class="block">Causes the objects prepared in transaction [tid] to be discarded.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tid</code> - the transaction id</dd>
<dd><code>worker</code> - the principal requesting the rollback</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../fabric/common/exceptions/AccessException.html" title="class in fabric.common.exceptions">AccessException</a></code> - if the principal differs from the caller of prepare()</dd>
</dl>
</li>
</ul>
<a name="read-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>read</h4>
<pre>public abstract&nbsp;<a href="../../../fabric/common/SerializedObject.html" title="class in fabric.common">SerializedObject</a>&nbsp;read(long&nbsp;onum)</pre>
<div class="block">Returns the object stored at a particular onum.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>onum</code> - the identifier</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the object or null if no object exists at the given onum</dd>
</dl>
</li>
</ul>
<a name="readGroup-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readGroup</h4>
<pre>public final&nbsp;<a href="../../../fabric/store/db/GroupContainer.html" title="class in fabric.store.db">GroupContainer</a>&nbsp;readGroup(long&nbsp;onum)</pre>
<div class="block">Returns a GroupContainer for the object stored at a particular onum.</div>
</li>
</ul>
<a name="getVersion-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getVersion</h4>
<pre>public&nbsp;int&nbsp;getVersion(long&nbsp;onum)
               throws <a href="../../../fabric/common/exceptions/AccessException.html" title="class in fabric.common.exceptions">AccessException</a></pre>
<div class="block">Returns the version number on the object stored at a particular onum.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../fabric/common/exceptions/AccessException.html" title="class in fabric.common.exceptions">AccessException</a></code> - if no object exists at the given onum.</dd>
</dl>
</li>
</ul>
<a name="notifyCommittedUpdate-fabric.store.SubscriptionManager-long-fabric.worker.remote.RemoteWorker-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>notifyCommittedUpdate</h4>
<pre>protected final&nbsp;void&nbsp;notifyCommittedUpdate(<a href="../../../fabric/store/SubscriptionManager.html" title="class in fabric.store">SubscriptionManager</a>&nbsp;sm,
                                           long&nbsp;onum,
                                           <a href="../../../fabric/worker/remote/RemoteWorker.html" title="class in fabric.worker.remote">RemoteWorker</a>&nbsp;worker)</pre>
<div class="block">Performs operations in response to a committed object update. Removes from
 cache the glob associated with the onum and notifies the subscription
 manager of the update.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>onum</code> - the onum of the object that was updated.</dd>
<dd><code>worker</code> - the worker that performed the update.</dd>
</dl>
</li>
</ul>
<a name="isPrepared-long-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isPrepared</h4>
<pre>public final&nbsp;boolean&nbsp;isPrepared(long&nbsp;onum,
                                long&nbsp;tid)</pre>
<div class="block">Determines whether an onum has an outstanding uncommitted conflicting
 change or read. Outstanding uncommitted changes are always considered
 conflicting. Outstanding uncommitted reads are considered conflicting if
 they are by transactions whose tid is different from the one given.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>onum</code> - the object number in question</dd>
</dl>
</li>
</ul>
<a name="isWritten-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isWritten</h4>
<pre>public final&nbsp;boolean&nbsp;isWritten(long&nbsp;onum)</pre>
<div class="block">Determines whether an onum has outstanding uncommitted changes.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>onum</code> - the object number in question</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if the object has been changed by a transaction that hasn't
         been committed or rolled back.</dd>
</dl>
</li>
</ul>
<a name="unpin-fabric.store.db.ObjectDB.PendingTransaction-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unpin</h4>
<pre>protected final&nbsp;void&nbsp;unpin(<a href="../../../fabric/store/db/ObjectDB.PendingTransaction.html" title="class in fabric.store.db">ObjectDB.PendingTransaction</a>&nbsp;tx)</pre>
<div class="block">Adjusts rwLocks to account for the fact that the given transaction is about
 to be committed or aborted.</div>
</li>
</ul>
<a name="newOnums-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>newOnums</h4>
<pre>public abstract&nbsp;long[]&nbsp;newOnums(int&nbsp;num)</pre>
<div class="block"><p>
 Returns a set of onums that aren't currently occupied. The ObjectDB may
 return the same onum more than once from this method, althogh doing so
 would encourage collisions. There is no assumption of unpredictability or
 randomness about the returned ids.
 </p>
 <p>
 The returned onums should be packed in the lower 48 bits. We assume that
 the object database is never full, and can always provide new onums
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>num</code> - the number of onums to return</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>num fresh onums</dd>
</dl>
</li>
</ul>
<a name="exists-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>exists</h4>
<pre>public abstract&nbsp;boolean&nbsp;exists(long&nbsp;onum)</pre>
<div class="block">Checks whether an object with the corresponding onum exists, in either
 prepared or committed form.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>onum</code> - the onum of to check</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if an object exists for onum</dd>
</dl>
</li>
</ul>
<a name="getName--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getName</h4>
<pre>public final&nbsp;java.lang.String&nbsp;getName()</pre>
<div class="block">Returns the name of this store.</div>
</li>
</ul>
<a name="close--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre>public abstract&nbsp;void&nbsp;close()
                    throws java.io.IOException</pre>
<div class="block">Gracefully shuts down the object database.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a name="isInitialized--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isInitialized</h4>
<pre>protected abstract&nbsp;boolean&nbsp;isInitialized()</pre>
<div class="block">Determines whether the object database has been initialized.</div>
</li>
</ul>
<a name="setInitialized--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setInitialized</h4>
<pre>protected abstract&nbsp;void&nbsp;setInitialized()</pre>
<div class="block">Sets a flag to indicate that the object database has been initialized.</div>
</li>
</ul>
<a name="ensureInit--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ensureInit</h4>
<pre>public final&nbsp;void&nbsp;ensureInit()</pre>
<div class="block">Ensures that the object database has been properly initialized. This
 creates, for example, the name-service map and the store's principal, if
 they do not already exist in the database.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../fabric/store/db/MemoryDB.html" title="class in fabric.store.db"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../fabric/store/db/ObjectDB.PendingTransaction.html" title="class in fabric.store.db"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?fabric/store/db/ObjectDB.html" target="_top">Frames</a></li>
<li><a href="ObjectDB.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
