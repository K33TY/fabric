public class Main
{ // this should be fabIL code that runs somewhere trusted.

    final principal{*←} customer = new SimplePrincipal("customer");  // @ root store
    final principal{*←} bank     = new SimplePrincipal("bank");      // @ root store
    final principal{*←} airline  = new SimplePrincipal("airline");   // @ root store

    Broker[bank, customer]{*←} broker;

    public void setup{*←}() {
        Account customerAcct = new Account(customer); // @ bank store
        customerAcct.credit(10000);

        Account airlineAcct = new Account(airline);   // @ bank store
        Tickets custTickets = new Tickets();          // @ airline store

        broker = new Broker(customerAcct, airlineAcct, custTickets, airline); // @ root store
    }

    void runit{}() {
	final Broker broker = this.broker;
	if (broker != null)
	    broker.coordinatePurchase();
    }
}
