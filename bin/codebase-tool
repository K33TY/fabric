#!/bin/bash

# Wrapper script for the Fabric GUI store browser 

source "$(dirname $0)/defs"

while true; do
  case "$1" in
    "") break;;
    -v) verbose="1"; shift;;
    -j)
            shift
            vmargs="$vmargs '$1'"
            shift
            ;;
    --debug)
            shift
            vmargs="$vmargs -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=3370"
            ;;
    -cp)
            shift
            classpath="$classpath:$1"
            shift
            ;;
    *) args="$args '$1'"; shift;;
  esac
done

classpath="$JIF/rt-classes:$classpath"
classpath="$TOP/classes:$TOP/rt-classes:$classpath"
classpath="$TOP/lib/fabric.jar:$classpath"
classpath="$TOP/lib/je-3.3.75.jar:$classpath"
classpath="$TOP/lib/FreePastry-2.1.jar:$classpath"
classpath="$TOP/tools/classloader/classes:$classpath"

command="\"$JAVA\" $vmargs -classpath \"$(fixpath $classpath)\" fabric.tools.classloader.CodebaseTool $args"

if [ -n "$verbose" ]
then
  echo "$command"
fi

eval "$command"
